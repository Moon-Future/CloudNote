## 依赖包

```shell
npm install webpack webpack-cli -D
```

## 模式

### mode: development

```js
// webpack.development.config.js
module.exports = {
+ mode: 'development'
- plugins: [
-   new webpack.NamedModulesPlugin(),
-   new webpack.DefinePlugin({ "process.env.NODE_ENV": JSON.stringify("development") }),
- ]
}
```

### mode: production

```js
// webpack.production.config.js
module.exports = {
+  mode: 'production',
-  plugins: [
-    new UglifyJsPlugin(/* ... */),
-    new webpack.DefinePlugin({ "process.env.NODE_ENV": JSON.stringify("production") }),
-    new webpack.optimize.ModuleConcatenationPlugin(),
-    new webpack.NoEmitOnErrorsPlugin()
-  ]
}
```

## 配置文件模板

### 单入口

```js
const { resolve } = require('path')

module.exports = {
  mode: 'development', // 'production' | 'development' | 'none'，默认 production
  
  // 入口文件
  entry: resolve(__dirname, 'src/index.js'),
    
  // 输出文件
  output: {
    path: resolve(__dirname, 'dist'),
    filename: 'bundle.js'
  },
    
  loader: [],
    
  plugins: []  
}

```

### 多入口

```js
const { resolve } = require('path')

module.exports = {
    mode: 'development', // 'production' | 'development' | 'none'，默认 production

    entry: {
        a: resolve(__dirname, 'src/a.js'),
        b: resolve(__dirname, 'src/b.js'),
        c: resolve(__dirname, 'src/c.js')
    },

    output: {
        path: resolve(__dirname, 'dist'),
        filename: 'js/[name].js'
    },

    plugins: []
}
```

## Loader

> *loader* 让 webpack 能够去处理那些非 JavaScript 文件（webpack 自身只理解 JavaScript）。loader 可以将所有类型的文件转换为 webpack 能够处理的有效模块，然后你就可以利用 webpack 的打包能力，对它们进行处理。

在更高层面，在 webpack 的配置中 **loader** 有两个目标：

1. `test` 属性，用于标识出应该被对应的 loader 进行转换的某个或某些文件。
2. `use` 属性，表示进行转换时，应该使用哪个 loader。（从右向左）

**用法**：

[`module.rules`](https://www.webpackjs.com/configuration/module/#module-rules) 允许你在 webpack 配置中指定多个 loader

```js
module: {
    rules: [
        {
            test: /\.(scss|sass)$/,
            // 先执行 sass-loader，再执行 css-loader，最后执行 style-loader
            use: ['style-loader', 'css-loader', 'sass-loader'],
        },
    ],
},
```

或者

```js
module: {
    rules: [
        {
            test: /\.css$/,
            use: [
                { loader: 'style-loader' },
                {
                    loader: 'css-loader',
                    options: {
                        modules: true
                    }
                },
                {
                    loader: 'sass-loader'
                }
            ]
        }
    ]
}
```

或者

```js
moduels: {
    rules: [
        {
            test: /\.js$/,
        	loader: 'babel-loader'
        }
    ]
}
```



## 常用 Loader

## 常用 Plugin

### html-webpack-plugin

> 基于 html 模板生成打包后的 html 文件

```shell
npm i html-webpack-plugin -D
```

```js
const { resolve } = require('path')
const HtmlWebpackPlugin = require('html-webpack-plugin')

{
    plugins: [
        new HtmlWebpackPlugin({
            template: resolve(__dirname, 'src/index.html'),
            filename: 'index.html',
        })
    ]
}
```

### webpack-dev-server

> 热编译，热刷新 HMR（HotModuleReplacement）

```shell
npm i webpack-dev-server -D
```

```js
const webpack = require('webpack')

{
    //  可选，如果打包路径不是 dist 可在此修改
    devServer: {
        conntentBase: './dist',
        hot: true
    },

    plugins: [
        new webpack.HotModuleReplacementPlugin()
    ]
}

// package.json
"scripts": {
    "hot": "webpack-dev-server"
},
```

`webpack --watch` 可以监听文件变化，热编译，但无法刷新页面（热刷新）

### babel

> **Babel 是一个 JavaScript 编译器**
>
> Babel 是一个工具链，主要用于将 ECMAScript 2015+ 版本的代码转换为向后兼容的 JavaScript 语法，以便能够运行在当前和旧版本的浏览器或其他环境中。

```shell
npm i babel-loader @babel/core @babel/preset-env @babel/plugin-transform-runtime -D
npm i @babel/runtime -S
## @babel/plugin-transform-runtime 依赖于 @babel/runtime
```

```js
// .babelrc
{
    "presets": [
        "@babel/preset-env"
    ],
    "plugins": [
        "@babel/plugin-transform-runtime"
    ]
}

// webpack.config.js
moduels: {
    rules: [
        {
            test: /\.js$/,
        	loader: 'babel-loader'
        }
    ]
}
```

### clean-webpack-plugin

> 清除构建文件夹（dist）

### copy-webpack-plugin

> 复制静态资源文件

```js
plugins: [
    new CopyWebpackPlugin([
        // {output}/file.txt
        { from: 'from/file.txt' },

        // equivalent
        'from/file.txt',

        // {output}/to/file.txt
        { from: 'from/file.txt', to: 'to/file.txt' },

        // {output}/to/directory/file.txt
        { from: 'from/file.txt', to: 'to/directory' },

        // Copy directory contents to {output}/
        { from: 'from/directory' },

        // Copy directory contents to {output}/to/directory/
        { from: 'from/directory', to: 'to/directory' },

        // Copy glob results to /absolute/path/
        { from: 'from/directory/**/*', to: '/absolute/path' },

        // Copy glob results (with dot files) to /absolute/path/
        {
            from: {
                glob:'from/directory/**/*',
                dot: true
            },
            to: '/absolute/path'
        },

        // Copy glob results, relative to context
        {
            context: 'from/directory',
            from: '**/*',
            to: '/absolute/path'
        },

        // {output}/file/without/extension
        {
            from: 'path/to/file.txt',
            to: 'file/without/extension',
            toType: 'file'
        },

        // {output}/directory/with/extension.ext/file.txt
        {
            from: 'path/to/file.txt',
            to: 'directory/with/extension.ext',
            toType: 'dir'
        }
    ], {
        ignore: [
            // Doesn't copy any files with a txt extension    
            '*.txt',

            // Doesn't copy any file, even if they start with a dot
            '**/*',

            // Doesn't copy any file, except if they start with a dot
            { glob: '**/*', dot: false }
        ],

        // By default, we only copy modified files during
        // a watch or webpack-dev-server build. Setting this
        // to `true` copies all files.
        copyUnmodified: true
    })
]
```

### optimize-css-assets-webpack-plugin

> 压缩 CSS

### mini-css-extract-plugin

> 将 CSS 提取为独立的文件的插件，对每个包含 css 的 js 文件都会创建一个 CSS 文件，支持按需加载 css 和 sourceMap

### terser-webpack-plugin

> 压缩 js，uglifyjs-js-webpack-plugin 不支持 es6 语法

